select * from swiggy_orders;

---First Method

select del_partner,sum( case when DATEDIFF(minute, order_time,deliver_time) > predicted_time then 1 else 0 end) as Delayed_Orders  from swiggy_orders
group by del_partner;

---Second Method

select a.del_partner,  isnull(Delayed_Orders,0) as Delayed_Orders  from
(select distinct del_partner from swiggy_orders)a left join 
(select del_partner, COUNT(*) as Delayed_Orders  from swiggy_orders
where DATEDIFF(minute, order_time,deliver_time) > predicted_time
group by del_partner) b on a.del_partner=b.del_partner ;